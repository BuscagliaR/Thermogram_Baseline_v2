"0","### Function that determines if the signal moves up or down"
"0","### Requires being provided first difference curve (i.e. the deltas)"
"0","run.indicators <- function(x) return(ifelse(x <= 0, -1, 1))"
"0",""
"0","### Function that counts runs of ups/downs"
"0","### Relies on the above function to count how many consecutive ups/downs"
"0","updown.count <- function(x){"
"0","  require(tidyverse)"
"0","  j = 1"
"0","  n.its <- length(x)"
"0","  df.out <- data.frame()"
"0","  count <- 1"
"0","  while(j <= n.its){"
"0","    if(x[j] == x[j+1] & j != n.its)"
"0","    {"
"0","      j <- j+1"
"0","      count <- count+1"
"0","    } else {"
"0","      out <- c(count, run.indicators(x[j]))"
"0","      df.out <- df.out %>% rbind(out)"
"0","      j <- j+1"
"0","      count <- 1"
"0","    }"
"0","  }"
"0","  colnames(df.out) <- c('RunSize', 'Up/Down')"
"0","  df.out$`Up/Down` <- ifelse(df.out$`Up/Down` < 0, 'Down', 'Up')"
"0","  return(df.out)"
"0","}"
