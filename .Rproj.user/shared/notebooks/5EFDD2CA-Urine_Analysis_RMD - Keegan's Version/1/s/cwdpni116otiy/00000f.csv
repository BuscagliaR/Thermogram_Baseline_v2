"0","### spline residuals into a data.frame with ids for tracking."
"0","r <- resid(full.spline.fit)"
"0","r.df <- data.frame(Temperature = working.sample$Temperature, "
"0","                   r=r, "
"0","                   id = 1:length(working.sample$Temperature))"
"0","### scan through lower region calculating variance within a window size of w"
"0","i=0"
"0","df.var <- data.frame()"
"0","### how far do we need to scan?"
"0","points.in.lower <- nrow(working.sample %>% filter(Temperature < exclude.lwr))"
"0","### scan and calculate variance for each window"
"0","while ((w+i) < points.in.lower){"
"0","  rout <- r.df %>% slice((1+i):(w+i)) %>% summarise(temp.stop=(w+i),mean = mean(r), sd=sd(r))"
"0","  df.var <- rbind(df.var, rout)"
"0","  i=i+1"
"0","}"
"0","### where was the minimum variance?"
"0","low <- df.var %>% filter(sd == min(sd))"
"0","lower <- working.sample$Temperature[low$temp.stop-w]"
"0","lower"
"1","[1]"
"1"," 51.72487"
"1","
"
