"0","### total size of thermogram"
"0","l <- length(working.sample$Temperature)"
"0","j=0"
"0","df.var.upper <- data.frame()"
"0","### how far from upper endpoint do we need to scan?"
"0","smallest.point.in.upr <- nrow(working.sample) - nrow(working.sample %>% filter(Temperature > exclude.upr))"
"0","### scan from highest point to region of exclusion"
"0","while ((l-w-j) > smallest.point.in.upr) {"
"0","  rout <- r.df %>% slice((l-w-j):(l-j)) %>% summarise(i=(l-w-j),mean = mean(r), sd=sd(r))"
"0","  df.var.upper <- rbind(df.var.upper, rout)"
"0","  j=j+1"
"0","}"
"0","### where was the minimum variance?"
"0","up <- df.var.upper %>% filter(sd == min(sd))"
"0","upper <- working.sample$Temperature[up$i+w]"
"0","upper"
"1","[1]"
"1"," 86.13848"
"1","
"
