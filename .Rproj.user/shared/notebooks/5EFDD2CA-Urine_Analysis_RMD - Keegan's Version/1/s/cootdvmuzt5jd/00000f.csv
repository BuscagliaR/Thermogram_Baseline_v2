"0","### auto.baseline"
"0","###"
"0","### @use"
"0","### Automatically determines a baseline for RAW thermograms and returns"
"0","### baseline subtracted set on a chosen temperature grid!"
"0","###"
"0","### @requires"
"0","### dplyr"
"0","###"
"0","### @inputs"
"0","### x : raw thermogram as data.frame with Temperature and dCp columns."
"0","### w : window size (default 90, try others!)"
"0","### exclusion.lwr : lower temperature exclusion point"
"0","### exclusion.upr : upper temperature exclusion point"
"0","### grid.temp : chosen temperature grid for final data"
"0","###"
"0","### @function"
"0","auto.baseline <- function(x, w = 90, exclusion.lwr = 60, exclusion.upr = 80,"
"0","                          grid.temp = seq(45, 90, 0.1), plot.on = FALSE)"
"0","{"
"0","  ### automate selection of endpoints"
"0","  endpoints <- moving.window("
"0","  x = working.sample,"
"0","  w = 90,"
"0","  exclusion.lwr = 60,"
"0","  exclusion.upr = 80)"
"0","### baseline subtraction with auto-selected upr/lwr points"
"0","  baseline.output <- baseline.subtraction.byhand("
"0","  x = working.sample, "
"0","  lwr.temp = endpoints$lower, "
"0","  upr.temp = endpoints$upper,"
"0","  plot.on = plot.on)"
"0","### generate a final sample on chosen grid!"
"0","  final.sample <- final.sample.interpolate("
"0","  x = baseline.output, "
"0","  grid.temp = seq(45, 90, 0.1),"
"0","  plot.on = plot.on)"
"0","### return the interpolated baseline-subtracted result"
"0","  return(final.sample)"
"0","}"
